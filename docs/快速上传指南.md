# å¿«é€Ÿä¸Šä¼ æŒ‡å—

## ğŸš€ æœ€ç®€å•çš„æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼Œæ— éœ€ä¿®æ”¹ PowerShell ç­–ç•¥ï¼‰

```cmd
upload-server-safe.bat 47.116.197.230
```

**ä¼˜ç‚¹ï¼š** ä¸éœ€è¦ä¿®æ”¹ PowerShell æ‰§è¡Œç­–ç•¥ï¼Œç›´æ¥ä½¿ç”¨

---

### æ–¹æ³•2ï¼šä¸´æ—¶å…è®¸ PowerShell è„šæœ¬ï¼ˆä¸€æ¬¡æ€§è®¾ç½®ï¼‰

åœ¨ PowerShell ä¸­æ‰§è¡Œï¼š

```powershell
# ä¸´æ—¶å…è®¸ï¼ˆä»…å½“å‰çª—å£ï¼‰
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process

# ç„¶åè¿è¡Œè„šæœ¬
.\upload-server-safe.ps1 -ServerIP "47.116.197.230"
```

---

### æ–¹æ³•3ï¼šä½¿ç”¨ Git Bashï¼ˆæ¨èï¼Œè·¨å¹³å°ï¼‰

```bash
cd /e/Tongxun

# ä½¿ç”¨ rsyncï¼ˆå¦‚æœå·²å®‰è£…ï¼‰
rsync -avz --exclude='.env' \
          --exclude='node_modules' \
          --exclude='logs' \
          --exclude='*.log' \
          server/ root@47.116.197.230:/var/www/tongxun/server/
```

---

## ğŸ“‹ å®Œæ•´æµç¨‹

### 1. ä¸Šä¼ ä»£ç 

é€‰æ‹©ä¸Šè¿°ä»»ä¸€æ–¹æ³•ä¸Šä¼ ã€‚

### 2. åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ

```bash
ssh root@47.116.197.230
cd /var/www/tongxun/server

# æ£€æŸ¥ .env æ–‡ä»¶é…ç½®
cat .env | grep DB_USER
# åº”è¯¥æ˜¾ç¤º: DB_USER=root

# å¦‚æœé…ç½®é”™è¯¯æˆ–ä¸¢å¤±ï¼Œæ¢å¤å®ƒ
chmod +x restore-env.sh
./restore-env.sh

# å®‰è£…ä¾èµ–ï¼ˆå¦‚æœæœ‰æ–°åŒ…ï¼‰
npm install

# é‡å¯æœåŠ¡
pm2 restart tongxun-server

# æŸ¥çœ‹æ—¥å¿—ç¡®è®¤
pm2 logs tongxun-server --lines 50
```

---

## âš¡ å¿«é€Ÿå‘½ä»¤ï¼ˆå¤åˆ¶ç²˜è´´ï¼‰

### ä¸Šä¼ å¹¶éƒ¨ç½²ï¼ˆGit Bashï¼‰

```bash
cd /e/Tongxun && \
rsync -avz --exclude='.env' --exclude='node_modules' --exclude='logs' --exclude='*.log' \
  server/ root@47.116.197.230:/var/www/tongxun/server/ && \
ssh root@47.116.197.230 "cd /var/www/tongxun/server && \
  chmod +x restore-env.sh && ./restore-env.sh && \
  npm install && pm2 restart tongxun-server && \
  pm2 logs tongxun-server --lines 20"
```

---

## ğŸ†˜ å¦‚æœé‡åˆ°é—®é¢˜

### PowerShell æ‰§è¡Œç­–ç•¥é”™è¯¯

**å¿«é€Ÿè§£å†³ï¼š**
```cmd
upload-server-safe.bat 47.116.197.230
```

æˆ–ä¸´æ—¶å…è®¸ï¼š
```powershell
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process
.\upload-server-safe.ps1 -ServerIP "47.116.197.230"
```

### .env æ–‡ä»¶è¢«è¦†ç›–

åœ¨æœåŠ¡å™¨ä¸Šæ¢å¤ï¼š
```bash
cd /var/www/tongxun/server
chmod +x restore-env.sh
./restore-env.sh
```

### ä¸Šä¼ å¤±è´¥

æ£€æŸ¥ï¼š
1. æœåŠ¡å™¨IPæ˜¯å¦æ­£ç¡®
2. SSHè¿æ¥æ˜¯å¦æ­£å¸¸
3. æ˜¯å¦å®‰è£…äº† scp/rsync å‘½ä»¤
